"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6811],{12425:function(e,t,n){n.r(t),n.d(t,{default:function(){return V}});var r=n(67294),a=n(53156),l=n(7452),o=n(39960),i=n(98906),u="$webmonetization.org/api/revshare/pay/",c="p",m=["#6ADAAB","#5DC495","#50AF7F","#439A6B","#368657","#297244","#1C5F32","#0E4C21","#003A10"];function s(e){return e.filter((function(e){return e.pointer&&Number(e.weight)}))}function h(e){var t=s(e);if(t.length){var n,r=function(e){return e.map((function(e){return e.pointer&&e.weight?[e.pointer,Number(e.weight),e.name]:void 0})).filter((function(e){return e}))}(t),a=(n=JSON.stringify(r),btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""));return u+a}}function p(e){try{var t=new URL(f(e)),n=new URLSearchParams(t.search).get(c)||t.pathname.split("/").pop();if(!n)throw new Error('No share data found. Make sure you copy the whole "content" field from your meta tag.');var r=JSON.parse(atob(n.replace(/\-/g,"+").replace(/_/g,"/")));if(!function(e){if(console.log("pointerList",e),!Array.isArray(e))return!1;for(var t,n=(0,i.Z)(e);!(t=n()).done;){var r=t.value;if("string"!=typeof r[0])return console.log("ptr not string",r),!1;if("number"!=typeof r[1])return console.log("weight not number",r),!1;if(r[2]&&"string"!=typeof r[2])return console.log("name not string",r),!1}return!0}(r))throw new Error('Share data is invalid. Make sure you copy the whole "content" from your meta tag.');return r.map((function(e){return{pointer:e[0],weight:e[1],name:e[2]}}))}catch(a){throw"TypeError"===a.name?new Error("Meta tag or payment pointer is malformed"):"SyntaxError"===a.name?new Error("Payment pointer has malformed share data. Make sure to copy the entire pointer."):a}}function g(e){var t,n=e.trim();if(!n)throw new Error("Tag or pointer is empty");return(t=n).startsWith(u)||t.startsWith(f(u))?p(n):function(e){var t=(new DOMParser).parseFromString(e,"text/html"),n=t.head.querySelector('meta[name="monetization"]');if(!n)throw console.log(t,t.head,t.head.querySelector('meta[name="monetization"]')),new Error("Please copy the exact meta tag you got from this revshare tool. It seems to be malformed.");return p(n.content)}(n)}function f(e){return e.startsWith("$")?"https://"+e.substring(1):e}function d(e){if(!e)return!0;if("string"!=typeof e)return!1;try{new URL(f(e));return!0}catch(t){return!1}}function E(e){return!e||!(isNaN(e)||Number(e)<0)}function v(e){if(!Array.isArray(e))return!1;for(var t,n=(0,i.Z)(e);!(t=n()).done;){var r=t.value;if(!d(r.pointer))return!1;if(!E(r.weight))return!1}return!0}var y="prob-revshare-shares",w=(0,r.createContext)();function b(e){var t=e.children,n=(0,r.useState)(function(){try{var e="undefined"==typeof window?void 0:localStorage.getItem(y),t=JSON.parse(e);return e&&t&&v(t)?t:[{name:"",pointer:"",weight:""}]}catch(n){if("SyntaxError"===n.name)return[{name:"",pointer:"",weight:""}];throw n}}()),a=n[0],l=n[1];return r.createElement(w.Provider,{value:[a,function(e){return localStorage.setItem(y,JSON.stringify(e)),l(e)}]},t)}function C(){return(0,r.useContext)(w)}var N={Shares:1,Import:2},S=(0,r.createContext)();function Z(e){var t=e.children,n=(0,r.useState)(N.Shares),a=n[0],l=n[1];return r.createElement(S.Provider,{value:[a,l]},t)}function x(){return(0,r.useContext)(S)}var P=n(9446);function I(e){return e.dataEntry.title}function k(){var e=function(e){return s(e).map((function(e,t){return{title:e.name||e.pointer,value:Number(e.weight),color:m[t%m.length]}}))}(C()[0]);return e.length?r.createElement(P.PieChart,{className:"revshareChart",data:e,style:{width:"100%",height:300},radius:30,label:I,labelStyle:function(){return{fill:"#000",fontFamily:'system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',fontSize:"5px"}},labelPosition:112}):r.createElement(r.Fragment,null)}var z=n(53816),A=n(53252),F=n(85754),M=n(87109),W=n(83321),R=n(46761);function D(e){var t=e.index,n=e.name,a=e.pointer,l=e.weight,o=e.percent,i=e.onChangeName,u=e.onChangePointer,c=e.onChangeWeight,m=e.onChangePercent,s=e.onRemove,h=e.removeDisabled,p=e.percentDisabled,g=e.weightDisabled;return r.createElement(z.Z,{key:t},r.createElement(A.Z,{className:"nameCell"},r.createElement(F.Z,{size:"small",className:"shareNameInput",type:"text",value:n,variant:"standard",onChange:function(e){i(e.target.value)}})),r.createElement(A.Z,{className:"pointerCell"},r.createElement(F.Z,{size:"small",className:"sharePointerInput",type:"text",value:a,variant:"standard",error:!d(a),helperText:!d(a)&&"Invalid payment pointer.",onChange:function(e){u(e.target.value)}})),r.createElement(A.Z,{className:"weightCell"},r.createElement(F.Z,{size:"small",className:"weightInput",type:"number",min:0,step:"any",value:l,variant:"standard",disabled:g,error:!E(l),helperText:!E(l)&&"Weight must be a positive number",onChange:function(e){c(e.target.value)}})),r.createElement(A.Z,{className:"percentCell"},r.createElement(F.Z,{size:"small",className:"percentInput",type:"number",min:0,max:100,step:"any",variant:"standard",value:o&&Math.round(100*o),disabled:p,onChange:function(e){m(e.target.value/100)},InputProps:{endAdornment:r.createElement(M.Z,{position:"end"},"%")}})),r.createElement(A.Z,{className:"removeCell",align:"right"},r.createElement(W.Z,{className:"removeButton",size:"small",disabled:h,onClick:function(){return s()}},r.createElement(R.Z,null))))}var B=n(72882),T=n(7906),U=n(53184),O=n(295);function L(e){var t=e.children;return r.createElement(B.Z,null,r.createElement(T.Z,{size:"small"},r.createElement(U.Z,null,r.createElement(z.Z,null,r.createElement(A.Z,null,r.createElement("b",null,"Name")),r.createElement(A.Z,null,r.createElement("b",null,"Pointer")),r.createElement(A.Z,null,r.createElement("b",null,"Weight")),r.createElement(A.Z,null,r.createElement("b",null,"Percent")),r.createElement(A.Z,null))),r.createElement(O.Z,null,t)))}function j(e,t,n){return[].concat(e.slice(0,t),[Object.assign({},e[t],n)],e.slice(t+1))}function J(e,t,n){return-e*(n-t)/(e-1)}function _(){var e=C(),t=e[0],n=e[1],a=x(),l=(a[0],a[1]),o=t.reduce((function(e,t){return e+Number(t.weight)}),0);return r.createElement("div",null,r.createElement(L,null,t.map((function(e,a){return r.createElement(D,{key:a,index:a,name:e.name,onChangeName:function(e){return n(j(t,a,{name:e}))},pointer:e.pointer,onChangePointer:function(e){return n(j(t,a,{pointer:e}))},weight:e.weight,onChangeWeight:function(e){return n(j(t,a,{weight:e}))},weightDisabled:!e.pointer,percent:Number(e.weight)?e.weight/o:void 0,percentDisabled:!e.pointer||t.length<=1,onChangePercent:function(r){return n(j(t,a,{weight:(l=J(r,e.weight,o),Number(l.toFixed(3)))}));var l},onRemove:function(){return n(function(e,t){return[].concat(e.slice(0,t),e.slice(t+1))}(t,a))},removeDisabled:t.length<=1})}))),r.createElement(W.Z,{variant:"outlined",onClick:function(){return n([].concat(t,[{name:"",pointer:"",weight:""}]))}},"Add Share"),r.createElement(W.Z,{variant:"outlined",className:"importSharesButton",onClick:function(){return l(N.Import)}},"Import Existing Revshare"))}function q(){var e=x(),t=(e[0],e[1]),n=C(),a=(n[0],n[1]),l=(0,r.useState)(""),o=l[0],i=l[1],u=(0,r.useState)(""),c=u[0],m=u[1];return r.createElement("div",null,r.createElement(F.Z,{label:"Enter your meta tag or payment pointer",multiline:!0,variant:"outlined",rows:4,fullWidth:!0,value:o,error:Boolean(c),helperText:c,onChange:function(e){i(e.target.value),m("")}}),r.createElement("div",{className:"importControls"},r.createElement(W.Z,{variant:"outlined",onClick:function(){return t(N.Shares)}},"Cancel"),r.createElement(W.Z,{variant:"outlined",className:"importSharesButton",onClick:function(){try{var e=g(o);a(e),t(N.Shares)}catch(n){m(n.message)}}},"Import")))}function Y(){return r.createElement("p",null,"Copy this meta tag into your site's ",r.createElement("code",null,"<head>")," to apply the revshare. Make sure it's the only Web Monetization meta tag on your site.")}function $(){var e=C()[0],t=h(e);return v(e)?t?r.createElement(r.Fragment,null,r.createElement(Y,null),r.createElement("code",{id:"metaTag"},'<meta name="monetization" content="',t,'">',r.createElement("img",{src:"/img/copy_icon.svg",id:"copyIcon",className:"btnClipboard"}))):r.createElement("p",null,"Please enter some shares with valid payment pointers and weights"):r.createElement("p",null,"Please fix the errors in your revshare.")}function G(){return r.createElement(r.Fragment,null,r.createElement("p",null,"Add all Payment Pointers that will receive a split of the revenue and name them (optional). By setting weights, you determine what share each Payment Pointer will receive. You can also tweak the percentage to adjust shares."),r.createElement("p",null,"If you want to edit an existing meta tag created with this tool, click 'Import existing revshare.' Note: Your inputs will be saved in your browser locally."))}function H(){return r.createElement(r.Fragment,null,r.createElement("p",null,"Copy your existing Web Monetization meta tag (found in your site's ",r.createElement("code",null,"<head>"),') into the box below. Click "Import" to load it into the editor.'),r.createElement("p",null,r.createElement("b",null,"Once you're finished editing, you must replace all old Web Monetization meta tags on your site with the newly generated one in order for the changes to take effect!")))}function K(e){var t=e.children,n=(0,r.useState)(!1),a=n[0],l=n[1];return(0,r.useEffect)((function(){l(!0)}),[]),a?t:r.createElement(r.Fragment,null)}function Q(){var e=x()[0];if(e===N.Shares)return r.createElement(r.Fragment,null,r.createElement("section",null,r.createElement("h2",null,"Editing Revshare"),r.createElement(G,null)),r.createElement(K,null,r.createElement(k,null),r.createElement(_,null),r.createElement("section",null,r.createElement("h2",null,"Meta Tag"),r.createElement($,null))));if(e===N.Import)return r.createElement(r.Fragment,null,r.createElement("h2",null,"Importing Revshare"),r.createElement(H,null),r.createElement(q,null));throw new Error("invalid view")}function V(e){var t=e.config;return r.createElement(l.Z,{permalink:"/prob-revshare",title:t.title,description:t.tagline},r.createElement(Z,null,r.createElement(b,null,r.createElement(a.Z,{maxWidth:"md",component:"section"},r.createElement("h1",null,"Probabilistic Revshare Generator"),r.createElement("p",null,"This tool allows you to create a Web Monetization meta tag which splits money between multiple Payment Pointers (",r.createElement(o.Z,{to:"/docs/probabilistic-rev-sharing"},"Learn more"),"). If you make changes to an existing meta tag with this tool, make sure to replace the old meta tag with the updated version."),r.createElement(Q,null)))))}}}]);